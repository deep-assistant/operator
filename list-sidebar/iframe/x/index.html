<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>X (Twitter) DMs - List + Sidebar - IFRAME</title>
    <link rel="stylesheet" href="../../../shared/css/operator.css">
    <style>
        .iframe-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .iframe-header {
            padding: 1rem 2rem;
            background: var(--surface);
            border-bottom: 1px solid var(--border);
        }

        .iframe-header h2 {
            font-size: 1.25rem;
            color: var(--text-primary);
        }

        .current-item-info {
            margin-top: 0.5rem;
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        iframe {
            flex: 1;
            border: none;
            width: 100%;
            background: white;
        }

        .sidebar {
            width: 300px;
        }
    </style>
</head>
<body>
    <div class="app">
        <header class="header">
            <div class="header-left">
                <a href="../../.." class="back-link" style="margin-right: 1rem;">‚Üê Back to Demos</a>
                <h1>X Direct Messages (Embedded)</h1>
            </div>
            <div class="controls">
                <div class="queue-info">
                    <span class="queue-count">Queue: <span id="queue-count">0</span></span>
                </div>
            </div>
        </header>

        <div class="main-content">
            <aside class="sidebar active">
                <div class="sidebar-header">
                    <h2>Unread DMs</h2>
                </div>
                <div class="card-list" id="item-list"></div>
            </aside>

            <div class="iframe-container">
                <div class="iframe-header">
                    <h2 id="current-item-title">X Messages</h2>
                    <div class="current-item-info" id="current-item-info">
                        Embedded X interface - log in to access your direct messages
                    </div>
                </div>
                <iframe id="x-iframe" src="https://twitter.com/messages"></iframe>
            </div>
        </div>
    </div>

    <script>
        // Sample X DMs (in a real app, fetch from X API)
        const xDMs = [
            { user: 'Tech Expert', username: 'techexpert', preview: 'Thanks for the follow! Would love...', time: '10m ago' },
            { user: 'Design Pro', username: 'designpro', preview: 'Your recent thread was really...', time: '30m ago' },
            { user: 'Code Master', username: 'codemaster', preview: 'Can I ask you about your tech...', time: '1h ago' },
            { user: 'Data Science', username: 'datascience', preview: 'Great work on your latest project!', time: '3h ago' },
            { user: 'DevOps', username: 'devops', preview: 'Would you be interested in a...', time: '4h ago' },
            { user: 'UX Designer', username: 'uxdesigner', preview: 'I have a question about your...', time: '6h ago' }
        ];

        let currentIndex = -1;

        function renderList() {
            const listContainer = document.getElementById('item-list');
            listContainer.innerHTML = '';

            xDMs.forEach((dm, index) => {
                const itemEl = document.createElement('div');
                itemEl.className = `list-item ${index === currentIndex ? 'active' : ''}`;
                itemEl.innerHTML = `
                    <div class="list-item-header">
                        <div class="list-item-source">@${dm.username}</div>
                        <div class="list-item-time">${dm.time}</div>
                    </div>
                    <div class="list-item-title">${dm.user}</div>
                    <div class="list-item-preview">${dm.preview}</div>
                `;
                itemEl.onclick = () => selectItem(index);
                listContainer.appendChild(itemEl);
            });

            document.getElementById('queue-count').textContent = xDMs.length;
        }

        function selectItem(index) {
            currentIndex = index;
            const dm = xDMs[index];

            document.getElementById('current-item-title').textContent = `DM with ${dm.user}`;
            document.getElementById('current-item-info').textContent = `@${dm.username} - ${dm.time}`;

            renderList();
        }

        // Initial render
        renderList();
    </script>
</body>
</html>
