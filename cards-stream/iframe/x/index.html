<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>X (Twitter) DMs - Focus Mode - IFRAME</title>
    <link rel="stylesheet" href="../../../shared/css/operator.css">
    <style>
        .focus-container {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 2rem;
        }

        .focus-card {
            width: 100%;
            max-width: 900px;
            height: 80vh;
            background: var(--surface);
            border-radius: 1rem;
            box-shadow: var(--shadow-lg);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .focus-header {
            padding: 1.5rem 2rem;
            background: var(--background);
            border-bottom: 1px solid var(--border);
        }

        .focus-header h2 {
            font-size: 1.5rem;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .focus-meta {
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        iframe {
            flex: 1;
            border: none;
            width: 100%;
            background: white;
        }

        .focus-footer {
            padding: 1.5rem 2rem;
            background: var(--background);
            border-top: 1px solid var(--border);
            display: flex;
            gap: 1rem;
        }

        .queue-indicator {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: var(--surface);
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            box-shadow: var(--shadow-lg);
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="app">
        <header class="header">
            <div class="header-left">
                <a href="../../.." class="back-link" style="margin-right: 1rem;">← Back to Demos</a>
                <h1>X Direct Messages (Focus + Embedded)</h1>
            </div>
        </header>

        <div class="main-content">
            <div class="focus-container">
                <div class="queue-indicator">
                    <span id="queue-indicator">Item 1 of 6</span>
                </div>

                <div class="focus-card">
                    <div class="focus-header">
                        <h2 id="current-title">X Messages</h2>
                        <div class="focus-meta" id="current-meta">Log in to view your direct messages</div>
                    </div>
                    <iframe id="x-iframe" src="https://twitter.com/messages"></iframe>
                    <div class="focus-footer">
                        <button class="btn-primary" onclick="handleDone()">
                            <span>✓</span> DONE
                        </button>
                        <button class="btn-secondary" onclick="handleNext()">
                            <span>→</span> NEXT
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const xDMs = [
            { user: 'Tech Expert', username: 'techexpert', time: '10m ago' },
            { user: 'Design Pro', username: 'designpro', time: '30m ago' },
            { user: 'Code Master', username: 'codemaster', time: '1h ago' },
            { user: 'Data Science', username: 'datascience', time: '3h ago' },
            { user: 'DevOps', username: 'devops', time: '4h ago' },
            { user: 'UX Designer', username: 'uxdesigner', time: '6h ago' }
        ];

        let currentIndex = 0;

        function showCurrentItem() {
            if (xDMs.length === 0) {
                document.getElementById('current-title').textContent = 'All done!';
                document.getElementById('current-meta').textContent = 'No more messages to process';
                return;
            }

            const dm = xDMs[currentIndex];
            document.getElementById('current-title').textContent = `DM with ${dm.user}`;
            document.getElementById('current-meta').textContent = `@${dm.username} - ${dm.time}`;
            document.getElementById('queue-indicator').textContent = `Item ${currentIndex + 1} of ${xDMs.length}`;
        }

        function handleDone() {
            if (xDMs.length === 0) return;
            xDMs.splice(currentIndex, 1);
            if (currentIndex >= xDMs.length && currentIndex > 0) {
                currentIndex = xDMs.length - 1;
            }
            showCurrentItem();
        }

        function handleNext() {
            if (xDMs.length === 0) return;
            const item = xDMs.splice(currentIndex, 1)[0];
            xDMs.push(item);
            showCurrentItem();
        }

        document.addEventListener('keydown', (e) => {
            if (e.key === 'd' || e.key === 'D') {
                e.preventDefault();
                handleDone();
            } else if (e.key === 'n' || e.key === 'N' || e.key === 'ArrowRight') {
                e.preventDefault();
                handleNext();
            }
        });

        showCurrentItem();
    </script>
</body>
</html>
